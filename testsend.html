<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <!-- <script src="./web3.min.js"></script>
    <script src="./psulogin.js"></script>  -->
</head>

<body>

  <h1>Send ERC20 Token</h1>

  <!-- <h2>Token Address</h2> -->
  <!-- <input type="text" id="contractAddresss" size="80" oninput="onAddressChange()"></input> -->
  <form id="submitSend" method="GET">

    <h2>FORM Address</h2>
    <input type="text" name="fromAddress" id="fromAddress" size="80"></input>
    <p>e.g. 0x6c25FE295Ecee6F0D8D34fC28dca2de68538fA4a</p>


    <h2>privateKey</h2>
    <input type="text" name="privateKey" id="privateKey" size="80"></input>
    <!-- <p>e.g. 0x6c25FE295Ecee6F0D8D34fC28dca2de68538fA4a</p> -->

    <h2>Recipients Address (Student ID)</h2>
    <input type="text" name="toAddress" id="toAddress" size="80"></input>
    <p>e.g. 5935512042</p>



    <h2>money</h2>
    <input type="number" name="money" id="money" size="80"></input>
    <br>
    <br>
    <button type="submit">Send ERC20</button>
    <!-- <input type="text" id="privateKey" size="80"></input>
  <p>e.g. 0x4e47581813943E481D1243953b9d951B9B6ef6Ec</p> -->
  </form>

  <!-- <button type="submit"><a href="http://http://localhost:8000/balance/5935512042" class="btn btn-default">Go to Google</a></button> -->

  <!-- <button onclick="window.location.href='/showdata.html'">Continue</button> -->
</body>
<script src="./web3.min.js"></script>
<!-- <script src="./psulogin.js"></script>  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
<script>
  var url;
  var id;
  (() => {
    url = window.location.href
    id = url.split('/').slice(-1).toString() // ไอดี ของผู้ login
  })()
  axios({
    method: 'GET',
    url: '/getWalletById', //ส่งไปค่านี้
    headers: {
      id: id  // รหัสนักศึกษา
    }
  }).then(result => { // ดึงค่ามาใส่ใน input ด้วย axios โดยตรง
    console.log("result", result)
    $('#fromAddress').val(result.data.address)
    $('#privateKey').val(result.data.privateKey)
  })

  document.querySelector('#submitSend').addEventListener('submit', e => {
    e.preventDefault()
    axios({ // ส่งค่าทั้งหมดไปๆ ยัง ฝั่ง nodejs
      method: 'GET',
      url: '/send/' + id + '/confirm', // ส่งไปยังค่านี้
      headers: {
        fromAddress: $('#fromAddress').val(),
        toAddress: $('#toAddress').val(),
        privateKey: $('#privateKey').val(),
        money: $('#money').val(),
        TEST: 'test string'

      }
    })
  })
</script>

</html>